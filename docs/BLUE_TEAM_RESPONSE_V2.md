# Blue Team Response to Red Team Critique V2

> **Date**: 2026-02-04  
> **Status**: Addressing all Critical Flaws

---

## Accepted Changes

| Critique ID | Change Made | Rationale |
|---|---|---|
| **CF-01** | 全質問をデフォルト回答で仮確定 | 「質問集」から「仕様書」への昇格 |
| **CF-02** | 正規化順序と具体例を明記 | クエリ・タイトル両方に適用、具体例追加 |
| **CF-03** | 用語を厳密に再定義 | Exact/Prefix/Partial/Containsを定義 |
| **CF-04** | 30文字閾値の根拠を追記 | 平均的なマンガタイトル長分析に基づく |
| **CF-05** | スピンオフキーワードを網羅的に列挙 | 全14キーワードを明記 |
| **CF-06** | ペナルティ免除を「完全一致」に変更 | 部分一致による誤免除を防止 |
| **CF-07** | 閾値40点の根拠と代替案を追記 | 動的閾値の検討も含む |
| **CF-08** | 巻数ボーナスにタイトル一致条件を追加 | タイトルスコアが30以上の場合のみ適用 |
| **CF-09** | 正規化前・後の両方でマッチング | 不可逆変換の問題を回避 |
| **CF-10** | 各挙動にソースコード参照を追加 | 仕様とコードの乖離を検証可能に |

---

## Accepted Changes (Medium Issues)

| Critique ID | Change Made | Rationale |
|---|---|---|
| **MI-01** | スコア計算式を一箇所に集約 | 公式を明記 |
| **MI-02** | 「トップ結果」を定義 | 最高スコアを持つ結果 |
| **MI-03** | 複数巻指定は非対応と明記 | スコープ外 |
| **MI-04** | 数字解釈ルールを追加 | 末尾数字のみ巻数とみなす |
| **MI-05** | 0巻・0.5巻の扱いを明記 | 第1巻ボーナス非適用 |

---

## Accepted Changes (Test Cases)

以下のエッジケースを仕様書に追加：
- 空文字列: エラー返却
- 絵文字: 除去して検索
- 全角英数: 半角に変換
- 超長クエリ: 100文字で切り捨て
- 特殊文字: サニタイズ

---

## Rejected Critiques

| Critique ID | Reason for Rejection |
|---|---|
| なし | 全批判を受け入れ |

---

## Implementation Notes

1. `SEARCH_SPEC_V2.md` を `SEARCH_SPEC_V3.md` として改訂
2. 「質問」セクションを「仕様」セクションに全面書き換え
3. ソースコードへのリンクを追加
