# æ¤œç´¢ä»•æ§˜æ›¸ V4ï¼ˆAPPROVED - Destructive Auditå¯¾å¿œç‰ˆï¼‰

> **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸ› ï¸ å®Ÿè£…ä¸­  
> **æœ€çµ‚æ›´æ–°**: 2026-02-04  
> **Destructive Auditã¸ã®å¯¾å¿œ**: 4ä»¶ã®Critical Vulnerabilitiesã‚’ä¿®æ­£

---

## 1. ã‚¹ãƒ”ãƒ³ã‚ªãƒ•åˆ¤å®šã®ç·©å’Œï¼ˆV1å¯¾å¿œï¼‰

### 1.1 å¤‰æ›´ç‚¹
- **ãƒšãƒŠãƒ«ãƒ†ã‚£å€¤ã®å¤‰æ›´**: `-100ç‚¹`ï¼ˆåœå¤–ç¢ºå®šï¼‰ã‹ã‚‰ **`-30ç‚¹`** ã«ç·©å’Œã€‚
- **ç†ç”±**: ã€Œãƒ•ã‚¡ãƒ³ãƒ–ãƒƒã‚¯ãƒ»ã‚ªãƒ–ãƒ»ã‚¶ãƒ»ãƒ‡ãƒƒãƒ‰ã€ã®ã‚ˆã†ã«ã€ã‚¿ã‚¤ãƒˆãƒ«è‡ªä½“ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹ã€Œæœ¬ç·¨ã€ãŒæ¤œç´¢ä¸èƒ½ã«ãªã‚‹ã®ã‚’é˜²ããŸã‚ã€‚
- **æŒ™å‹•**: 
  - æœ¬ç·¨ï¼ˆContains Match +50ï¼‰ - ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼ˆ-30ï¼‰ = **+20ç‚¹**ï¼ˆç”Ÿå­˜ï¼‰
  - å®Œå…¨ã«ç„¡é–¢ä¿‚ãªã‚¹ãƒ”ãƒ³ã‚ªãƒ•ï¼ˆ+0ï¼‰ - ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼ˆ-30ï¼‰ = **-30ç‚¹**ï¼ˆé™¤å¤–ï¼‰

---

## 2. ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã®å¼·åŒ–ï¼ˆV2å¯¾å¿œï¼‰

### 2.1 ãƒˆãƒ¼ã‚¯ãƒ³ä¸€è‡´ãƒœãƒ¼ãƒŠã‚¹ï¼ˆToken Match Bonusï¼‰
ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šæ¤œç´¢ï¼ˆã€Œé€²æ’ƒ å·¨äººã€ï¼‰ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¿½åŠ ï¼š

1. **Exact/Contains Match** ãŒä¸æˆç«‹ã®å ´åˆã«è©•ä¾¡ã€‚
2. ã‚¯ã‚¨ãƒªã‚’ã‚¹ãƒšãƒ¼ã‚¹ã§åˆ†å‰²ã—ã€ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã€‚
3. **ã™ã¹ã¦ã®ãƒˆãƒ¼ã‚¯ãƒ³**ãŒã‚¿ã‚¤ãƒˆãƒ«ã«å«ã¾ã‚Œã‚‹å ´åˆã€ãƒœãƒ¼ãƒŠã‚¹ **`+30ç‚¹`** ã‚’ä»˜ä¸ã€‚

**ä¾‹**:
- Query: `é€²æ’ƒ å·¨äºº`
- Title: `é€²æ’ƒã®å·¨äºº`
- ContainsMatch: âœ• (`é€²æ’ƒå·¨äºº` != `é€²æ’ƒã®å·¨äºº`)
- TokenMatch: â—‹ (`é€²æ’ƒ` in Title AND `å·¨äºº` in Title) -> **+30ç‚¹**

---

## 3. ãƒã‚¤ã‚ºé™¤å»ãƒ•ã‚£ãƒ«ã‚¿ã®å¼·åŒ–ï¼ˆV3å¯¾å¿œï¼‰

### 3.1 çµ¶å¯¾è¶³åˆ‡ã‚Šãƒ©ã‚¤ãƒ³ï¼ˆAbsolute Floorï¼‰
ãƒˆãƒƒãƒ—ã‚¹ã‚³ã‚¢ã«é–¢ã‚ã‚‰ãšã€ä»¥ä¸‹ã®åŸºæº–ã§ç„¡æ¡ä»¶ã«çµæœã‚’é™¤å¤–ã™ã‚‹ï¼š

```typescript
// ã‚¹ã‚³ã‚¢15ç‚¹æœªæº€ã¯ã€Œã‚´ãƒŸã€ã¨ã¿ãªã—ã¦å¸¸ã«é™¤å¤–
results = results.filter(r => r.score >= 15);
```

### 3.2 ç›¸å¯¾ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆExistingï¼‰
ãã®ä¸Šã§ã€ãƒˆãƒƒãƒ—ã‚¹ã‚³ã‚¢ãŒé«˜ã„å ´åˆï¼ˆ>=40ï¼‰ã¯ã€ãƒã‚¤ã‚¯ã‚ªãƒªãƒ†ã‚£ãªçµæœã®ã¿ã‚’æ®‹ã™ï¼ˆ>=40ï¼‰ã€‚

---

## 4. ã‚¯ã‚¨ãƒªåˆ¶é™ã®å®Ÿè£…ï¼ˆV4å¯¾å¿œï¼‰

### 4.1 åˆ‡ã‚Šæ¨ã¦å‡¦ç†ï¼ˆTruncationï¼‰
- 100æ–‡å­—ã‚’è¶…ãˆã‚‹ã‚¯ã‚¨ãƒªã¯ã‚¨ãƒ©ãƒ¼ã«ã›ãšã€**å…ˆé ­100æ–‡å­—ã§åˆ‡ã‚Šæ¨ã¦ã¦**æ¤œç´¢ã‚’å®Ÿè¡Œã™ã‚‹ã€‚
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å„ªå…ˆï¼ˆã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’è¦‹ã›ãªã„ï¼‰ã€‚

---

## 5. ã‚¹ã‚³ã‚¢è¨ˆç®—å¼ï¼ˆæ›´æ–°ï¼‰

```
TotalScore = (ContainsMatch ? 50 : 0)
           + (TokenMatch ? 30 : 0)  // New! (Mutual Exclusive with ContainsMatch)
           + (VolumeMatch ? 100 : 0)
           + (Volume1Bonus ? 20 : 0)
           + (ShortTitle ? 10 : 0)
           + EditionPenalty (-5)
           + SpinoffPenalty (-30)   // Changed from -100
           + AdultPenalty (-1000)
```

---
